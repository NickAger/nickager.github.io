---
layout: post
title: "Configuring Jekyll"
date: 2015-11-22
tags: [Jekyll, blog]
excerpt_separator: <!--more-->
---

By adopting [Jekyll](http://jekyllrb.com) to replace my [previous blog]({% post_url 2015-11-10-From Pier to Jekyll %}) my goals were:

* Low or ideally a zero maintenance blog.
* Take advantage of [GitHub's free hosting](https://pages.github.com), to host the site directly from a [GitHub repository](https://github.com/NickAger/nickager.github.io).
* Use GitHub to automatically [generate](https://help.github.com/articles/creating-pages-with-the-automatic-generator/) the site for me.

The final item in the list means that [Jekyll plug-ins](http://jekyllrb.com/docs/plugins/) are ruled-out unless they are supported by GitHub. The result is it can take a little longer to find a workable solution to any problem as many search results will contain fixes that are not supported by the GitHub deployment of [Jekyll](http://jekyllrb.com).

<!--more-->

## Getting the basics working

I found a useful introduction [here](http://jmcglone.com/guides/github-pages/). However be aware that the [quick start guide](http://jekyllrb.com) shows:

```bash
~ $ gem install jekyll
~ $ jekyll new my-awesome-site
~ $ cd my-awesome-site
~/my-awesome-site $ jekyll serve
# => Now browse to http://localhost:4000
```

... which results in subtly different parsing and errors, which became evident when GitHub mailed-me with an unspecific `Page build failure` with no indication of the error:

![](/images/blog/new-blog-infrastructure/unhelpfulgithubmessage.png)

The solution is to make sure your local installation of [Jekyll](http://jekyllrb.com) matches the version used by GitHub.

## Installing the GitHub version of Jekyll

From [Jekyll and GitHub pages](https://jekyllrb.com/docs/github-pages/):

> Our friends at GitHub have provided the github-pages gem which is used to manage Jekyll and its dependencies on GitHub Pages. Using it in your projects means that when you deploy your site to GitHub Pages, you will not be caught by unexpected differences between various versions of the gems.

Create a `Gemfile` in the root folder of your site as:

```
source 'https://rubygems.org'
gem 'github-pages'
```

and install the GitHub gem with:

```
bundle install
```

then build your site with:

```
bundle exec jekyll build --safe
```

All this is documented on GitHub - '[Setting up your Pages site locally with Jekyll](https://help.github.com/articles/setting-up-your-pages-site-locally-with-jekyll/)' - if only I'd read that first!

## Configuring Travis to report build errors
An alternative to installing Jekyll locally is to setup [Travis](https://travis-ci.org) to build the site and then have access to any [build errors in the Travis build log](https://help.github.com/articles/viewing-jekyll-build-error-messages/).

My `.travis.yml` ended up as:

```yml
language: ruby
script: "bundle exec jekyll build"
rvm:
  - 2.1.8
```

I also added the following line to my `_config.yml` file:

```
exclude: [vendor] # for travis
```

which will ensure that Jekyll ignores the Travis build folder; more detail [here](https://jekyllrb.com/docs/continuous-integration/)  

The result is Travis sends me mails when Jekyll generates an error:

![](/images/blog/new-blog-infrastructure/travis-error-mail.png)

and the Travis build log points me to the source of the error:

![](/images/blog/new-blog-infrastructure/travis-error-screen.png)

Note: I find both having a local matching installation of Jekyll and Travis setup to build really useful. The local installation is perfect for quick previews when I'm iterating on styles or content. Travis is ideal when I'm not at my main laptop and I can edit directly in GitHub and recover if I inadvertently make a mistake.

When locally iterating I use the flags `--incremental` and `--watch` to ensure the local site build is updated as soon as I save a file:

```bash
bundle exec jekyll build --incremental --watch
```

and

```bash
bundle exec jekyll serve
```

## Customisations

The default theme generated by `jekyll new my-awesome-site` is functional, and includes a usable CSS menu adaption for mobile devices, however the look and feel is fairly basic. Amongst other sites, I was inspired by the [Octopress](http://octopress.org) theme used by a friend at [http://norbert.hartl.name](http://norbert.hartl.name) as well as the [navigation pills](http://getbootstrap.com/components/#nav-pills) defined by [Bootstrap](http://getbootstrap.com).

Other sites I've found useful while customising Jekyll for my purpose include:

* [Jekyll templates and Liquid templating language](https://jekyllrb.com/docs/templates/)
* [Creating GitHub pages with the automatic generator](https://help.github.com/articles/creating-pages-with-the-automatic-generator/)
* [Edit link on page](http://rgardler.github.io/2015/07/26/add-edit-me-link-for-github-pages)
* [Stack overflow: "Jekyll/Liquid Templating: How to group blog posts by year?"](http://stackoverflow.com/questions/19086284/jekyll-liquid-templating-how-to-group-blog-posts-by-year)
* [Next/previous blog posts links ](http://david.elbe.me/jekyll/2015/06/20/how-to-link-to-next-and-previous-post-with-jekyll.html)
* [How to use GitHub issues for comments](http://ivanzuzak.info/2011/02/18/github-hosted-comments-for-github-hosted-blogs.html)
* [Introduction to Jekyll and details of how to use github commenting in your blog](http://loyc.net/2014/blogging-on-github.html)
* [Post excerpts](https://jekyllrb.com/docs/posts/#post-excerpts)
* [How to list your Jekyll posts by tag](http://www.jokecamp.com/blog/listing-jekyll-posts-by-tag/)
* [Sitemaps for GitHub Pages](https://help.github.com/articles/sitemaps-for-github-pages/)
* [Captioned images](http://stackoverflow.com/questions/19331362/using-an-image-caption-in-markdown-jekyll)
* [GitHub corner image]( http://tholman.com/github-corners/)

As with all sites hosted directly from a GitHub repository, the raw site files are available for perusal [github](https://github.com/NickAger/nickager.github.io)
